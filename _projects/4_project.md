---
layout: page
title: Methods in population genomics
description: Ongoing project
img: assets/img/toolbox.jpg
importance: 3
datatable: true
category: resources
---

There are many methods in population genomics. To help newcomers in the field, we published a review on the main methods in the field, available [here](https://doi.org/10.1111/mec.15989) 


| Software  | Class of method  | Purpose  | Specifics  | Issues and warnings  | Link  | Reference |
|----------|----------|----------|----------|----------|----------|----------|
| POPGenome  |  Differentiation/Diversity/Recombination  |  Computing summary statistics based on AFS and LD along genomes  |  Accepts VCF and GFF/GFT files, efficient and fast. Tests for admixture available (ABBA BABA test). Includes basic coalescence simulations (ms and msms)  |  Mostly limited to summary statistics (but coalescent simulations are possible). No built-in SNP calling module  |  http://catchenlab.life.illinois.edu/stacks/  |  (Pfeifer et al., 2014)    | 
| ANGSD  |  Differentiation/Diversity/Recombination  |  Computing summary statistics based on AFS and LD along genomes  |  Able to process BAM files, built-in procedures for data filtering, admixture analysis. Suited for low-depth data. Includes a suite of methods to estimate relatedness (NGSRelate).  |  Mostly limited to summary statistics. Tutorials not always up-to-date.  |  https://github.com/ANGSD/angsd ; https://github.com/ANGSD/NgsRelate  |  (Korneliussen et al., 2014; Hanghøj et al., 2019)    | 
| Arlequin  |  Differentiation/Diversity/Recombination  |  Computing summary statistics based on AFS and LD along genomes  |  Can output AFS for further analysis in fastsimcoal2  |  Slower than PopGenome, requires a specific format and file conversion.  |  http://cmpg.unibe.ch/software/arlequin35/Arl35Downloads.html  |  (Excoffier and Lischer, 2010)    | 
| VCFTOOLS  |  Differentiation/Diversity/Recombination  |  Computing summary statistics based on AFS and LD along genomes  |  Fast. VCFTOOLS can also be used for SNP filtering  |  Less summary statistics than POPGenome  |  https://vcftools.github.io/man_latest.html  |  (Danecek et al., 2011)    | 
| ATLAS  |  Differentiation/Diversity/Recombination  |  Low depth sequencing/ancient samples analsis  |  Particularly suited for analyzing ancient samples. Includes sets of tools to call variants, estimate post-mortem damage, inbreeding, genetic diversity. Produces the input file for PSMC (demography from a single diploid genome)  |  Better used in combination with GATK pipelines. Still in development  |  https://bitbucket.org/wegmannlab/atlas/wiki/Home  |  (Link et al., 2017)    | 
| POPTREE2  |  Genetic differentiation  |  Visualizing a matrix of pairwise differentiation statistics as a tree  |  Can be used for pooled datasets, several statistics can be used  |  Differentiation measures alone do not necessarily retrieve the actual history of populations  |  http://www.med.kagawa-u.ac.jp/~genomelb/takezaki/poptree2/index.html  |  (Takezaki et al., 2010)    | 
| EEMS  |  Landscape genomics  |  Estimating barriers to gene flow in a spatial context  |  Estimates pairwise relatedness between all samples, and compares it to isolation-by-distance expectations to identify barriers to gene flow and corridors of higher connectivity. Can handle both haploid and diploid data  |  Requires to convert VCF file into PLINK binary format. Estimates effective migration rates (does not disantangle migration rates and effective population sizes). Setting parameters for the MCMC chain requires some trial-and-error  |  https://github.com/dipetkov/eems  |  (Petkova et al., 2015)    | 
| MAPS  |  Landscape genomics  |  Estimating barriers to gene flow in a spatio-temporal context  |  Expands on EEMS, but takes into account the phase to reconstruct past changes in connectivity. Can disentantle migration rates and effective population sizes (unlike EEMS)  |  Relies on identity-by-descent tracks, requiring phasing (for example using BEAGLE). A pipeline to obtain IBD tracks is available, with a few details here: https://github.com/halasadi/ibd_data_pipeline/issues/1  |  https://github.com/halasadi/MAPS  |  (Al-Asadi et al., 2019)    | 
| TESS3R  |  Landscape genomics  |  Grouping individuals in clusters maximizing HW equilibrium and LD between loci  |  Incorporates geographic information of samples. Can run genome scans of selection based on contrasting ancestral and modern allele frequencies.  |  Importing data requires using conversion tools found in the LEA suite  |  https://bcm-uga.github.io/TESS3_encho_sen/  |  (Caye et al., 2016)    | 
| SNPRelate  |  Multivariate analysis  |  Summarizing variance across loci and visualizing inter-individual genetic distance  |  Fast. Can use VCF files as an input  |  Requires careful interpretation (Jombard et al. 2009)  |  https://bioconductor.org/packages/release/bioc/html/SNPRelate.html  |  (Zheng et al., 2012)    | 
| Eigenstrat/smartpca  |  Multivariate analysis  |  Summarizing variance across loci and visualizing inter-individual genetic distance  |  Fast. Can use VCF files as an input  |  Requires careful interpretation (Jombard et al. 2009)  |  https://github.com/DReichLab/EIG/tree/master/EIGENSTRAT  |  (Price et al., 2006)    | 
| DAPC (adegenet)  |  Multivariate analysis/Clustering  |  Maximizes divergence between groups identified by PCA  |  Fast. Less sensitive to HWE assumptions. Claims to be more efficient than Structure  |  Requires careful interpretation (Jombard et al. 2009)  |  http://adegenet.r-forge.r-project.org/  |  (Jombart et al., 2010)    | 
| sPCA (adegenet)  |  Multivariate analysis/Clustering  |  Spatially explicit model to assess population structure  |  Spatially explicit and able to detect cryptic structure. Fast.  |  Does not take into account HW equilibrium or LD  |  http://adegenet.r-forge.r-project.org/  |  (Jombart et al., 2008)    | 
| LAMP  |  Pedigree, Identity by descent/state  |  Chromosome painting, relatedness  |  LAMP also allows for association and pedigree analyses  |  Identifies local ancestry in windows (source of noise), requires phased data  |  http://lamp.icsi.berkeley.edu/lamp/  |  (Baran et al., 2012)    | 
| PLINK  |  Pedigree, Identity by descent/state  |  Estimating inbreeding and relatedness  |  Allows studying identity by descent and by state. PLINK is a multi-purpose tool, facilitating data analysis within the same software  |  NA  |  http://pngu.mgh.harvard.edu/~purcell/plink/  |  (Purcell et al., 2007)    | 
| VCFTOOLS  |  Pedigree, Identity by descent/state  |  Estimating inbreeding and relatedness  |  Computes unadjusted Ajk and kinship coefficient  |  NA  |  https://vcftools.github.io/man_latest.html  |  (Danecek et al., 2011)    | 
| KING  |  Pedigree, Identity by descent/state  |  Estimating inbreeding and relatedness, multivariate analysis  |  Mendelian error checking, testing family structure, highly accurate kinship coefficient, association analysis, population structure inference  |  Kinship coefficient also computed in VCFTOOLS  |  http://people.virginia.edu/~wc9c/KING/Download.htm  |  (Manichaikul et al., 2010)    | 
| COLONY  |  Pedigrees  |  Pedigree inference from SNPs  |  Robust even with high error rates (e.g. low-depth sequencing). Can handle haplo-diploids systems (e.g. ants). Multi-threaded.  |  Can only simulate genotypes with the Windows version.  |  https://www.zsl.org/science/software/colony  |  (Wang, 2019)    | 
| sequoia  |  Pedigrees  |  Pedigree inference from SNPs  |  Can be applied to large pedigrees (>1000 individuals). Accomodates unknown birth times.  |  Handles hundreds of SNPs. For whole-genome data, preliminary filtering and LD-pruning may be recommended. Efficient with ~100 SNPs.  |  https://cran.r-project.org/web/packages/sequoia/index.html  |  (Huisman, 2017)    | 
| LDHat  |  Recombination  |  Estimating variation in recombination rates along a genome  |  Handles unphased and missing data, underlying model can be used for organisms such as viruses or bacteria  |  Limited to 300 sequences, specific format (not VCF), model for recombination hotspots based on human data  |  http://ldhat.sourceforge.net/  |  (McVean et al., 2002)    | 
| LDHot  |  Recombination  |  Identifying recombination hotspots  |  Specifically designed for detecting recombination hotspots  |  Requires data to be phased, working with LDHat  |  https://github.com/auton1/LDhot  |  (Myers et al., 2005)    | 
| iSMC  |  Recombination  |  Recombination from a single diploid genome  |  No phasing needed. Accepts VCF files as input.  |  Introgression and demographic misspecification may bias results. No detailed tutorial  |  https://github.com/gvbarroso/iSMC  |  (Barroso et al., 2018)    | 
| LDHelmet  |  Recombination  |  Estimating variation in recombination rates along a genome  |  Higher accuracy than LDHat  |  Requires phased data. Does not handle VCF, only fasta and fastq formats. Requires dividing the genome in short segments to be analysed in parallel.  |  https://sourceforge.net/projects/ldhelmet/  |  (Chan et al., 2012)    | 
| pyrho | Recombination |  Estimating variation in recombination rates along a genome | Fast. Takes both phased and unphased data as input. Can take into account the demographic history (to be inferred with, e.g. MSMC2) | Outputs a recombination rate (r), but internally calculates rho (4xNexr) and rescales by the provided Ne. Uncertainties in Ne propagate on r. | https://github.com/popgenmethods/pyrho | (Spence and Song, 2019) |

<div class="caption">
    Table 1: Summary of methods dedicated to infer population structure.
</div>




|Software  | Class of method  | Purpose  | Specifics  | Issues and warnings  | Link  | Reference  |
|----------|----------|----------|----------|----------|----------|----------|
| ARGWeaver/ARGweaver-D  | Ancestral Recombination Graphs/coalescence  | Retracing the whole process of recombination and coalescence along a genome  | Provides quantitative estimates for TMRCA and topologies at each locus. ARGWeaver-D can estimate introgression. Estimates effective population size. Provides tools to extract summary statistics for the topologies retrieved. Does not require phasing (but slower).  | High computing cost. Slower on unphased or low depth data. ARGWeaver-D is not part of the Anaconda (Python) distribution (http://compgen.cshl.edu/ARGweaver/doc/argweaver-d-manual.html)  | Can be installed via conda: conda install -c genomedk argweaver and https://github.com/mjhubisz/argweaver and http://compgen.cshl.edu/ARGweaver/doc/argweaver-d-manual.html  | (Rasmussen et al., 2014; Hubisz et al., 2020)   |
| GAPIT3  | Association  | Detecting association with environmental/phenotypical features  | Includes most methods for GWAS studies, including procedures for fast computation, mixed linear models, efficient mixed model association, bayesian methods such as BLINK, diagnostics such as QQ plots and genotype filtering.  | May be slow for very large datasets  | https://github.com/jiabowang/GAPIT3  | (Wang and Zhang, 2020)   |
| GEMMA  | Association  | Detecting association with environmental/phenotypical features  | Computationnally efficient for large scale datasets  | Imports data from PLINK format  | http://www.xzlab.org/software.html  | (Zhou and Stephens, 2012)   |
| GENABEL  | Association  | Detecting association with environmental/phenotypic features  | Modularity, facilitates correction for population structure/relatedness.  | Imports data from PLINK format. No longer supported!  | http://www.genabel.org/  | (Aulchenko et al., 2007)   |
| PLINK  | Association  | Detecting association with environmental/phenotypical features  | Handles a variety of tests for population structure and relatedness  | Population structure/kinship need to be assessed prior association analysis  | http://pngu.mgh.harvard.edu/~purcell/plink/  | Purcell et al., 2007)   |
| Trinculo  | Association  | Detecting association with environmental/phenotypical features  | Specifically designed to handle categorical variables with more than 2 categories. Performs multinomial logistic regression and provides frequentist and bayesian frameworks.  | Requires lapack library in Unix. Allows fine-mapping by testing for corrrelations between adjacent markers.  | https://sourceforge.net/projects/trinculo/  | (Jostins and McVean, 2016)   |
| SAMBADA  | Association/Environmental association  | Detecting association with environmental/phenotypical features  | Designed to be fast, underlying models have been kept simple. Allows conversion from PLINK format. Takes into account spatial autocorrelation of individual genotypes. Allows correction for population structure  | Does not work with pooled data. Possibly high levels of false positives. Relatedness between samples should be assessed independently. Should be used in combination with LFMM or BayPass.  | http://lasig.epfl.ch/sambada  | (Stucki et al., 2016)   |
| Relate  | Coalescence with recombination  | Reconstruct genome-wide genealogies for hundreds of samples  | Provides quantitative estimates for TMRCA and topologies at each locus. Infers past demography (similar to PSMC methods). Infers changes in mutation rates. Performs scans for positive selection over discrete time periods.  | Requires an outgroup to polarize alleles as ancestral/derived. Requires a recombination map. Does not reconstruct ARG sensus stricto, and does not estimate uncertainty of the local genealogies  | https://myersgroup.github.io/relate/index.html  | (Speidel et al., 2019)   |
| diCal-IBD  | Coalescent with recombination/IBD  | Predicting IBD tracts from demographic models  | High IBD sharing suggests recent positive selection.  | Uses diCal output to obtain expectations based on demographic scenarios  | https://sourceforge.net/projects/dical-ibd/  | (Tataru et al., 2014)   |
| VolcanoFinder  | Composite likelihood test  | Adaptive introgression  | Detects a specific signature of increase then drop in diversity near a selected locus brought in a population through introgression  | Private input format. Computationnally intensive, needs to be run in parallel.  | http://degiorgiogroup.fau.edu/vf.html  | (Setter et al., 2020)   |
| SCCT  | Conditional coalescent tree  | Detecting positive selection  | Designed for detecting recent positive selection. Clains to be more precise at identifying selected sites  | The ancestral state of alleles must be obtained through an outgroup  | https://github.com/wavefancy/scct  | (Wang et al., 2014)   |
| LFMM2  | Environmental association  | Detecting adaptation to environmental features  | Corrects for population structure (and other non-measured systematic biases) using latent factors, faster than BAYENV for large datasets  | Only performs association with environment. Implemented in the LEA package. Requires imputation (no missing data).  | http://membres-timc.imag.fr/Olivier.Francois/LEA/tutorial.htm | (Caye et al. 2019; Frichot et al., 2013)   |
| CLUES  | Genealogies at selected loci  | Estimate the time at which a beneficial allele rises in frequency  | Previous version used ARGWeaver output, current version uses Relate. Provides scripts to plot the trajectory of selected alleles.  | Assumes a panmictic population, neglects the effects of selection at linked sites.  | https://github.com/35ajstern/clues  | (Stern et al., 2019)   |
| PALM  | Genealogies at selected loci  | Estimate the strength and timing of selection on polygenic traits  | Uses genealogies estimated from Relate and results from GWAS to estimate timing and strength of selection for polygenic traits. Should be robust to pleiotropy and residual structure in GWAS  | May overestimate selection for older events. Only tested in humans.  | https://github.com/35ajstern/palm  | (Stern et al., 2020)   |
| startmrca  | Genealogies at selected loci  | Estimate the time at which a beneficial allele rises in frequency  | Compares genealogies between carriers and non-carriers of an advantageous mutation, assuming a star- genealogy at selected loci. Can handle VCF files  | Requires a reference panel of noncarrier haplotypes. Sensitive to loca diversity before the sweep, and to migration events during a sweep. More indicated for recent sweeps.  | https://github.com/jhavsmith/startmrca  | Smith, Coop, Stephens, & Novembre, 2018)   |
| Ancestry_HMM-S   | Identity-by-state tracts  | Adaptive introgression  | Estimates the selective coefficient of the introgressed loci through a hidden-Markov chain approach.  | Requires the time and extent of introgression to be defined by the user  | https://github.com/jesvedberg/Ancestry_HMM-S/  | (Svedberg​ et al., 2020)   |
| H12 test  | LD  | Detecting selection using signatures of high LD  | Does not require phased data. Designed for detecting soft sweeps  | Coalescent simulations are recommended to evaluate the likelihood of selection  | https://github.com/ngarud/SelectionHapStats/  | (Garud et al., 2015)   |
| LDna  | LD  | Detecting selection using signatures of high LD  | Can be used to address population structure or detect large inversions or indel polymorphism through LD  | The user needs to play with parameters to ensure robustness of SNPs significantly linked  | https://github.com/petrikemppainen/LDna  | (Kemppainen et al., 2015)   |
| rehh  | LD  | Detecting selection using signatures of high LD  | Can compute both XP-EHH and Rsb. Handles several input formats  | Requires phased data and high density of markers  | https://cran.r-project.org/web/packages/rehh/index.html  | (Gautier and Vitalis, 2012)   |
| Scan for epistatic interaction (based on LD)  | LD  | Polygenic selection/Epistatic interactions  | Uses genome-wide LD between a candidate locus and the rest of the genomes to identify epistatic interactions. Can test SNP-SNP interaction, or between genomic windows (summarizes genotypes through PCA)  | Lack of a detailed tutorial  | https://github.com/leaboyrie/LD_corpc1  | (Boyrie et al., 2020)   |
| Selscan  | LD  | Detecting selection using signatures of high LD  | Includes the nSL statistics dedicated to soft sweep detection  | Does not include utilities to specify the ancestral state of alleles. Requires phased data and high density of markers  | https://github.com/szpiech/selscan  | (Szpiech and Hernandez, 2014)   |
| BALLET  | Likelihood test for balancing selection  | Detecting balancing selection  | Designed for detecting ancient balancing selection. Does not require phasing  | Requires whole-genome data and recombination map. The ancestral state of alleles must be obtained through an outgroup  | http://www.personal.psu.edu/mxd60/ballet.html  | (DeGiorgio et al., 2014)   |
| Betascan2  | Local associations of allele frequencies  | Detecting balancing selection  | Uses correlations in frequencies between genomically proximate SNPs to compute a score. Can incorporate information about ancestral/derived alleles, fixed derived variants and normalizes the statistics depending on the amount of sites in a given genomic window. Very detailed tutorial and utilities.  | Requires estimating the length distribution of ancestral fragments on each side of the selected site. The 95% percentile can be estimated with the formula L=-log(0.05)/(T x rho), with T the time since selection in generations and rho the effective recombination rate/ generation.  | https://github.com/ksiewert/BetaScan  | (Siewert and Voight, 2017, 2020)   |
| NCD statistics  | Local associations of allele frequencies  | Detecting balancing selection  | Examines the observed and expected frequency spectra of polymorphisms in genomic windows to test for selection. Can incorporate fixed differences with an outgroup (NCD2), but not mandatory (NCD1)  | Private input format, requires simulations to calibrate the statistics. Requires to define the expected equilibrium frequency of alleles (usually between 0.3 and 0.5). Low sensitivity below these frequencies.  | https://github.com/bbitarello/NCD-Statistics  | (Bitarello et al., 2018)   |
| Bayescan  | Population differentiation  | Detecting positive selection and local adaptation  | Incorporates uncertainty on allele frequencies due to low sample sizes  | Sensitive to priors on the ratio of selected/neutral sites. False positive rates can be high under scenarios of demographic expansion, admixture and isolation by distance  | http://cmpg.unibe.ch/software/BayeScan/  | (Foll and Gaggiotti, 2008)   |
| FDIST2  | Population differentiation  | Detecting positive selection and local adaptation  | Allows to control for hierarchical population structure  | False positive rate is high when an island model cannot be assumed  | http://datadryad.org/resource/doi:10.5061/dryad.v8d05  | (Beaumont and Balding, 2004)   |
| PCAdapt  | Population differentiation  | Detecting positive selection and local adaptation  | Does not require to define populations. Handles admixed populations and pooled datasets  | False positive rate can be high  | http://membres-timc.imag.fr/Michael.Blum/PCAdapt.html  | (Duforet-Frebourg et al., 2016)   |
| SelEstim  | Population differentiation  | Detecting positive selection and local adaptation  | Can estimate the coefficients of selection. Calibration using a pseudo-observed dataset (can be used in combination with the R function simulate.baypass() in BayPass).  | Assumes a Wrigth-Fisher island model.  | http://www1.montpellier.inra.fr/CBGP/software/selestim/  | (Vitalis et al., 2014)   |
| Bayenv, BayPass  | Population differentiation/Association  | Detecting positive selection and adaptation to environmental features  | Less sensitive to population demographic history than previous methods. Handle pooled datasets  | Significance thresholds need to be determined from pseudo-observed datasets. Calibration with neutral SNPs is recommended. BayPass better estimates the kinship matrix  | http://www1.montpellier.inra.fr/CBGP/software/baypass/ ; https://bitbucket.org/tguenther/bayenv2_public/src  | (Günther and Coop, 2013; Gautier, 2015)   |
| FLK  | Population differentiation/Association  | Detecting positive selection and local adaptation  | Less sensitive to population demographic history than previous methods  | Requires an outgroup population  | https://qgsp.jouy.inra.fr/index.php?option=com_content&view=article&id=50&Itemid=55  | (Bonhomme et al., 2010)   |
| LSD  | Population differentiation/Population-branch test  | Detecting positive selection and local adaptation  | Compares the level of exclusively shared differences between internal and external branches of a population tree. Allows testing selection occurring on the ancestral branch leading to two populations.  | Requires several populations to perform the test. May be less sensitive to selection on standing variation.  | https://bitbucket.org/plibrado/LSD  | (Librado and Orlando, 2018)   |
| POPBAM  | Summary statistics  | Detecting selection using AFS, differentiation  | Extracts summary statistics directly from BAM files  | Does not allow for sophisticated filtering and SNP calling  | http://popbam.sourceforge.net/  | (Garrigan, 2013)   |
| VCFTOOLS  | Summary statistics  | Detecting selection using AFS, differentiation  | Extracts summary statistics from VCF files. Also allows VCF filtering and conversion  | Set of summary statistics not as extensive as PopGenome  | http://vcftools.sourceforge.net/  | (Danecek et al., 2011)   |
| RAiSD  | Summary statistics/Allele frequency spectrum + LD  | Detecting positive selection and local adaptation  | Scans the genome for composite signals of selective sweeps summarized by the μ statistics. Corrects for the effects of background selection by estimating a threshold value for the statistics based on simulations with background selection  | Uses a single population of interest.  | https://github.com/alachins/raisd  | (Alachiotis and Pavlidis, 2018)   |
| TASSEL  | Summary statistics/Association  | Detecting association with phenotype  | User friendly (Java interface), corrects for relatedness, allows computing summary statistics (LD, diversity)  | Requires relatedness to be assessed externally (with e.g. STRUCTURE)  | http://www.maizegenetics.net/tassel  | (Bradbury et al., 2007)   |
| ANGSD  | Summary statistics/Association/Population Branch test  | Detecting selection using AFS, differentiation, association with functional traits  | Allows for association using generalized linear models  | Descriptive statistics. P-values need to be evaluated through coalescent simulations.  | http://www.popgen.dk/angsd/index.php/ANGSD  | (Korneliussen et al., 2014)   |
| SweeD  | Summary statistics/Composite Likelihood test  | Designed for whole genome data (or large continuous regions)  | Supports Fasta and VCF formats. Estimates selection coefficients.  | NA  | http://pop-gen.eu/wordpress/software/sweed  | (Degiorgio et al., 2016)   |
| selectionTools  | Summary statistics/LD  | Detecting selection using AFS, differentiation and LD statistics  | Allows combining several tools in a single pipeline. Includes phasing tools.  | Set of available summary statistics remains limited (same as VCFtools + Fay and Wu's H)  | https://github.com/MerrimanLab/selectionTools  | (Cadzow et al., 2014)   |
| PAML/CODEML  | Summary statistics/phylogeny  | Distribution of fitness effects/selection on coding variation  | Estimates selection along branches in a phylogeny for genes of interest, contrasting patterns of synonymous and non-synonymous substitutions. A detailed tutorial is available here: https://link.springer.com/protocol/10.1007%2F978-1-4939-1438-8_4#Sec29  | Slow for large datasets. Needs to be parallelised.  | http://abacus.gene.ucl.ac.uk/software/paml.html  | (Yang, 2007)   |
| polyDFE2.0  | Summary statistics/phylogeny  | Distribution of fitness effects/selection on coding variation  | Can test for invariance of DFEs across datasets (genomic regions within species, or different species). No need for divergence estimates (does not assume that the same DFE is shared between species and outgroup). Very detailed tutorial available here: https://link.springer.com/protocol/10.1007/978-1-0716-0199-0_6  | Comparisons require a large number of SNPs for each dataset for comparisons to be meaningful  | https://github.com/paula-tataru/polyDFE  | (Tataru and Bataillon, 2019)   |
| POPGenome  | Summary statistics/Population Branch test  | Detecting selection using AFS, differentiation  | Fast, embedded in R, allows using annotation files (GFF/GTF format).  | Does not perform association, but can be used in combination with GENABEL within R  | https://cran.r-project.org/web/packages/PopGenome/index.html  | (Pfeifer et al., 2014)   |


<div class="caption">
    Table 2: Summary of methods dedicated to detect selection
</div>



| Software |Class of method |Purpose |Specifics |Issues and warnings |Link |Reference |
|----------|----------|----------|----------|----------|----------|----------|
| Dsuite |ABBA-BABA |Identifying past events of admixture between populations |Fast, handles VCF format. Suited for low-depth sequencing (handles uncertainties on genotypes). Provides a set of summary statistics that are useful to investigate complex admixture events |Requires an outgroup sequence. The methods cannot estimate the direction of gene flow. |https://github.com/millanek/Dsuite |(Malinsky et al., 2020) |
| RENT+ |Ancestral Recombination Graphs/coalescence |Retracing the whole process of recombination and coalescence along a genome |Faster than first version of ARGWeaver. |Requires phased haplotypes. Specific input format. No built-in functions to extract information from genealogies. |https://github.com/SajadMirzaei/RentPlus |(Mirzaei and Wu, 2017) |
| TREEMIX |Clustering and characterizing admixture |Admixture graph, infers most likely admixture events in a tree |Based on allele frequencies and can be used for pooled data. |Requires multiple runs to properly assess the likelihood of each model |https://bitbucket.org/nygcresearch/treemix/src |(Pickrell and Pritchard, 2012) |
| G-PhoCS |Coalescence/Bayesian |Estimating population divergence and migration parameters using a coalescent framework |Bayesian + MCMC, handles ancient samples |Parameters scaled by mutation rate, no admixture |http://compgen.cshl.edu/GPhoCS/ |(Gronau et al., 2011) |
| IMa3 |Coalescence/Bayesian |Inferring parameters from an isolation with migration (IM) model |Fully bayesian approach, can perform joint estimates of parameters in L-mode and test for nested models. Can estimate phylogenetic relationships and migration rates |IM model is the only one available. Discrete admixture cannot be tested. Can only use subsets of whole-genome resequencing data. Recent splits lead to overestimate migration rates |https://github.com/jodyhey/IMa3 |(Hey and Nielsen, 2007) |
| ABLE |Coalescence/Composite Likelihood |Model comparison and parameters estimation |Uses both allele frequency spectrum and linkage disequilibrium within blocks of a pre-specified size. |Relies on ms syntax. Determining the most informative size for blocks requires performing pilot runs. |https://github.com/champost/ABLE |(Beeravolu et al., 2016) |
| Stairway2 |Coalescence/Composite Likelihood |Inferring change in Ne with time |User-friendly. Fast. Suitable for pools or low-depth sequencing. |Cannot handle migration or population splits. |https://github.com/xiaoming-liu/stairway-plot-v2 |(Liu and Fu, 2020) |
| fastsimcoal2 |Coalescence/Likelihood |Model comparison and parameters estimation |Performs coalescent simulations, parameter estimation and model testing using a fast likelihood method. Can handle arbitrarily complex scenarios for any type of marker |The maximum-likelihood method only uses the allele frequency spectrum. Several runs (20-100) are needed to explore the likelihood space. |http://cmpg.unibe.ch/software/fastsimcoal2/ |(Excoffier et al., 2013) |
| ∂a∂i |Diffusion approximation of the AFS |Model comparison and parameters estimation |Run time does not depend on the number of SNPs included, does not require coalescent simulations, handles arbitrarily complex scenarios. Fast estimation of confidence intervals around parameters estimates (Godambe method). Suitable for pools/low-depth sequencing |requires some knowledge of Python. Limited to 3 populations. Several runs (20-100) are needed to explore the likelihood space. |https://bitbucket.org/gutenkunstlab/dadi |(Gutenkunst et al., 2009) |
| moments |Diffusion approximation of the AFS |Model comparison and parameters estimation |Based on Python, syntax similar to ∂a∂i. Can handle selection. Can use VCF files as input. |Requires some knowledge of Python. Limited to 5 populations. Several runs (20-100) are needed to explore the likelihood space. |https://bitbucket.org/simongravel/moments/src/master/ |(Jouganous et al., 2017) |
| momi2 |Diffusion approximation of the AFS |Model comparison and parameters estimation |Can scale to ten populations. Can simulate and read data in the VCF format. Detailed tutorials available |Does not handle continuous gene flow |https://github.com/popgenmethods/momi2 |(Kamm et al., 2020) |
| KIMTree |Diffusion approximation/Bayesian |Estimating divergence time between populations and testing for topologies. Estimate divergence times and past effective sex-ratio along branches of a populations tree. |Fast and user-friendly. R scripts to obtain plots are available. Suitable for pools/low-depth sequencing. The method is conditional on a prior topology provided by the user. It computes DIC for a given topology, allowing to test for the best one. |Strong selection on the sex chromosome can produce male-biased sex-ratios. Times are given in diffusion time scale, and can be converted in demographic times using independent estimates of Ne. |http://www1.montpellier.inra.fr/CBGP/software/kimtree/download.html |(Clemente et al., 2018) |
| GADMA |Genetic algorithm |Model comparison and parameters estimation |Based on moments and ∂a∂i. Automates the search for the best set of models explaining a given frequency spectrum. |Limited to three populations at the moment. |https://github.com/ctlab/GADMA |(Noskova et al., 2020) |
| DoRIS |Identity by Descent (IBD) tract |Testing various demographic scenario |Uses variation in IBD tracts length to test for various demographic models. |IBD must be inferred first with, e.g., BEAGLE. Handles a limited set of demographic scenarios. Modification in the code is required for more complex scenarios |https://github.com/pierpal/DoRIS |(Palamara and Pe’er, 2013) |
| Unnamed. |Identity by state (IBS) tract |Predict observed patterns of Identity by state along a genome by fittingan appropriate, arbitrary complex demographic model |Allows bootstrapping and estimating confidence over parameter estimates with ms |Specific input format (similar to MSMC or ARGWeaver) |https://github.com/kelleyharris/Inferring-demography-from-IBS |(Harris and Nielsen, 2013) |
| ASTRAL-2 |Phylogeny |Builds species trees using short non-recombining sequences |Coalescence-based. Suitable for short loci (e.g. RAD-seq and GBS) |More reliable under high incomplete lineage sorting that SVDQuartets and NJst (Chou et al. 2015) |https://github.com/smirarab/ASTRAL |(Mirarab and Warnow, 2015) |
| BEAST2 |Phylogeny |Network reconstruction and phylogenetic relationships |User friendly. Can be used to track changes in effective population sizes (Bayesian Skyline Plots). Possible to estimate divergence times |Slow for large datasets. Requires sequence data that can be produced by , e.g., Stacks for RAD-seq data |http://beast2.org/ |(Drummond and Rambaut, 2007; Bouckaert et al., 2014) |
| IQ-Tree 2 |Phylogeny |Divergence time estimation and phylogenetic relationships |User-friendly, can be run locally or on a webserver, very detailed tutorials. Fast and accurate. |Still no tutorial for analyzing big data (last checked December 2020). |http://www.iqtree.org/ |(Minh et al., 2020) |
| MCMCTree and MCMCTreeR |Phylogeny |Divergence time estimation and phylogenetic relationships |Included in PAML. A R program is designed to help choosing relevant priors and interpreting results https://github.com/PuttickMacroevolution/MCMCtreeR |Bayesian, sensitive to priors. Requires a resolved phylogeny and an alignment. Slow for large datasets. Not suited for recent divergence and high gene flow. |http://abacus.gene.ucl.ac.uk/software/paml.html |(Yang, 2007; Puttick, 2019) |
| NJst |Phylogeny |Builds species trees using short non-recombining sequences |Available in the R package phybase. Estimates populations/species tree from gene trees |Requires splitting part of the genome into non-recombining "loci". |https://github.com/bomeara/phybase/ |(Liu and Yu, 2010, 2011) |
| PHRAPL |Phylogeny |Admixture graph, reticulated evolution |Uses trees in the NEWICK format as an input to infer topology, migration rates, divergence times. Similar to ABC in spirit, using tree topology as a summary statistics. |Cannot handle more than 16 taxa at a time, and requires subsetting larger datasets |http://www.phrapl.org/ |(Jackson et al., 2017) |
| PhyML |Phylogeny |Phylogenetic relationships |Maximum Likelihood inference of phylogenetic relationships. An online version is available |Should be used on complex of species or divergent populations with little migration. Can be ran on genomic windows to detect introgression (with e.g. TWISST, Dsuite) |http://www.atgc-montpellier.fr/phyml/binaries.php |(Guindon et al., 2010) |
| RAxML |Phylogeny |Network reconstruction and phylogenetic relationships |Maximum Likelihood inference of phylogenetic relationships |Should be used on complex of species or divergent populations with little migration |http://sco.h-its.org/exelixis/web/software/raxml/index.html |(Stamatakis, 2014) |
| SNAPP |Phylogeny |Phylogenetic relationships |Handles SNP data |Remains slow for medium to large datasets (>1,000SNPs) |http://beast2.org/snapp/ |(Bryant et al., 2012) |
| SNPhylo |Phylogeny |Network reconstruction and phylogenetic relationships |Complete pipeline from SNP filtering to tree reconstruction |Should be used on complex of species or divergent populations with little migration |http://chibba.pgml.uga.edu/snphylo/ |(Lee et al., 2014) |
| SVDQuartets |Phylogeny |Phylogenetic relationships |Estimates populations/species tree from gene trees |Remains slow for large datasets. Requires PAUP*. |https://www.asc.ohio-state.edu/kubatko.2/software/SVDquartets/ |(Chifman and Kubatko, 2014) |
| SVDQuest |Phylogeny |Phylogenetic relationships |Estimates populations/species tree from gene trees |Faster than SVDQuartets |https://github.com/pranjalv123/SVDquest |(Vachaspati and Warnow, 2018) |
| * BEAST |Phylogeny and species tree inference |Divergence time estimation and phylogenetic relationships |Outputs a species tree instead of concatenated gene tree. Allows for testing consistency between phylogenetic signals at different loci |Slow for large datasets. Requires sequence data. Not suited for situations where gene flow/admixture is important |http://beast2.org/ |(Heled and Drummond, 2010) |
| Splitstree |Phylogeny/Network |Network reconstruction and phylogenetic relationships |User friendly interface, proposes a variety of methods for networks reconstruction |Mostly descriptive |http://www.splitstree.org/ |(Huson and Bryant, 2006) |
| diCal2 |Sequentially Markovian coalescent |Testing any arbitrary demographic scenario |Works with smaller, more fragmented datasets than PSMC. Handles more complex demographic models than MSMC (including admixture). |Requires phased whole genome data and a model to be defined |https://sourceforge.net/projects/dical2/ |(Sheehan et al., 2013) |
| MSMC and MSMC-IM |Sequentially Markovian coalescent |Inferring change in Ne and migration rates with time between two populations |Allows to track population size changes in time without a priori. Allows estimating variation in cross-coalescence rate between two populations |Limited to the study of 8 diploid individuals from 2 populations at once. Requires whole genome phased data and masking regions with insufficient sequencing depth |https://github.com/stschiff/msmc and https://github.com/wangke16/MSMC-IM |(Schiffels and Durbin, 2014) |
| PSMC |Sequentially Markovian coalescent |Inferring change in effective population sizes (Ne) with time using a single diploid genome |Allows to track population size changes in time without a priori. |Limited to one population and one diploid individual. Better used within MSMC. Requires phased whole genome data and masking regions with insufficient sequencing depth |https://github.com/lh3/psmc |(Li and Durbin, 2011) |
| SMC++ |Sequentially Markovian coalescent |Inferring change in Ne with time and splitting time between two populations |Can analyze hundreds of individuals at a time and does not require phasing |Masking regions as in MSMC. The ancestral allele is assumed to be the reference allele by default. Assumes a clean split for populations divergence. Future versions should allow gene flow inference. |https://github.com/popgenmethods/smcpp |(Terhorst et al., 2016) |
| TWISST |Topology weighting |Chromosome painting, clustering and branching between populations |Retrieves the most likely coalescence pattern between several taxa along the genome. Can be seen as an extension of the ABBA/BABA test |Needs a priori grouping of individuals into taxa. Requires at least 4 taxa. Impractical for more than 6 taxa. Windows size must include enough SNPs to retrieve the correct topology but at the risk that regions with different histories are included |https://github.com/simonhmartin/twisst |(Martin and Van Belleghem, 2016) |

<div class="caption">
    Table 3: Summary of methods dedicated to reconstruct demographic history
</div>



| Software |Class of method |Purpose |Specifics |Issues and warnings |Link |Reference |
|----------|----------|----------|----------|----------|----------|----------|
| abc/abcrf |ABC |Performs all steps for model-checking and parameters estimation for ABC analyses. abcrf includes random forest methods (a type of supervised machine-learning) |Informative vignette, allows graphical representation, complete and robust |Does not perform coalescent simulations (but can be used in combination with coala) |https://cran.r-project.org/web/packages/abc/index.html ; https://cran.r-project.org/web/packages/abcrf/index.html |(Csilléry et al., 2012; Raynal et al., 2019) |
| ABCToolbox |ABC |Complete ABC analysis, from simulations to model checking and parameters estimation |Modular, facilitates the computation of summary statistics |NA |https://bitbucket.org/wegmannlab/abctoolbox/wiki/Home |(Wegmann et al., 2010) |
| DIYABC |ABC |Complete ABC analysis, from simulations to model checking and parameters estimation |User-friendly. Many ways to check goodness-of-fit. Good introduction to ABC models. |Does not model continuous gene flow. |http://www1.montpellier.inra.fr/CBGP/diyabc/ |(Cornuet et al., 2008) |
| PopSizeABC |ABC |Inferring change in Ne using whole-genome data |Supposed to better assess recent events. Uses a set of summary statistics for the AFS and LD between markers. Handles multiple individuals |Approximate bayesian approaches do not retrieve the whole information |https://forge-dga.jouy.inra.fr/projects/popsizeabc/ |(Boistard et al., 2016) |
| coala |ABC/coalescent simulations |Combining coalescent simulators within a single framework |Facilitates the building of scenarios and computes summary statistics for simulations. Can be easily combined with the abc or abc-rf packages in R. |Includes so far ms, msms and scrm |https://cran.r-project.org/web/packages/coala/index.html |(Staab and Metzler, 2016) |
| FacSexCoalescent |coalescent simulations |Simulate demographic scenarios for asexual/facultatively sexual species |Can handle varying levels of sexual reproduction, inbreeding, selfing and cloning. |Does not handle population size changes nor selection yet. |https://github.com/MattHartfield/FacSexCoalescent ; https://github.com/MattHartfield/FacSexCoalescentR |(Hartfield et al., 2016) |
| fastsimcoal2 |coalescent simulations |Building any arbitrary scenario using a coalescent framework |Any arbitrary scenario can be implemented. Handles SNP, microsatellites and sequence data. |Does not handle selection. Slower than ms with no recombination, much faster with recombination (see manual) |http://cmpg.unibe.ch/software/fastsimcoal2/ |(Excoffier and Foll, 2011) |
| ms, msms, msABC |coalescent simulations |Building any arbitrary scenario using a coalescent framework |Any arbitrary scenario can be implemented. Handles SNP, microsatellites and sequence data. msms can include selection in the model. |Syntax can be difficult to handle for new users compared to, e.g., fastsimcoal2 (but see coala) |http://www.bio.lmu.de/~pavlidis/home/?Software:msABC |(Hudson, 2002; Ewing and Hermisson, 2010; Pavlidis et al., 2010) |
| msms |coalescent simulations |Simulate demographic scenarios including selection |Flexible, syntax similar to ms, handles arbitratily complex models. Can be used in an ABC framework to include selection as a parameter to be estimated |Syntax can be difficult to handle for the naive user (but see coala) |http://www.mabs.at/ewing/msms/index.shtml |(Ewing and Hermisson, 2010) |
| scrm |coalescent simulations |Fast simulation of chromosome-scale sequences |Syntax similar to ms, handles any arbitrary scenario |Does not handle gene conversion and fixed number of segregating sites (unlike ms) |https://scrm.github.io/ |(Staab et al., 2015) |
| SPLATCHE3 |coalescent simulations |Simulating demographic scenarios in their spatial context |Coalescent simulator for genetic data, forward-in-time for demography in space. Spatially explicit. |Simulations can be slow (>1 hour) for large datasets (>100,000 SNPs) over more than 1,000 generations. Does not incorporate selection |http://www.splatche.com/splatche3 |(Currat et al., 2019) |
| Coalescence |discoal |Simulate selective sweeps under arbitrary demographic scenarios |Relatively fast for short genomic fragments. Designed to simulate "hard" and "soft" sweeps. |Mostly used with diploS/HIC. Other simulators such as msms may be more suited for some scenarios. |https://github.com/kr-colab/discoal |(Kern and Schrider, 2016) |
| QuantiNemo2 |Forward-in-time simulations |Simulating demographic and selection scenarios in their spatial context |Comprehensive simulator.Designed for the study of selection in a spatially-explicit context. Simulates quantitative traits, fitness landscapes and underlying genetic variation with migration. Include both population and individual-based simulations |Scan be slow for large/complex models |https://www2.unil.ch/popgen/softwares/quantinemo/ |(Currat et al., 2019)(Neuenschwander et al., 2019) |
| SliM3 |Forward-in-time simulations |Simulating genomic sequences with intrinsic and extrinsic factors |One of the most comprehensive simulators. Can simulate genetic data in their spatio-temporal context, the effects of selection at linked sites, coding and non-coding variation, inbreeding and selfing. Supports tree-sequence recording for faster simulations. Large community. |Slow for large genomic regions/large populations |https://messerlab.org/slim/ |(Haller and Messer, 2019) |
| diploS/HIC |Supervised Machine Learning |Detecting selective sweeps |Classifies genomic windows as neutral, selected, or impacted by selection at linked sites. Also distinguishes between selection on standing and de novo variation. Uses a set of summary statistics describing frequency spectrum and LD, does not require phasing. Good tutorial explaining the pipeline. |Good performance depends on the parameters used to simulate sweeps (window size, selective coefficient, demography). Requires some trial and error for new model species. Interpretation of "soft" and "hard" sweeps remains discussed. |https://github.com/kr-colab/diploSHIC |(Schrider and Kern, 2016; Kern and Schrider, 2018) |
| evoNet |Supervised Machine Learning |Detecting selective sweeps, balancing selection, and estimate demographic history |Uses deep-learning algorithms to classify genomic regions as selected or neutral, and estimate effective population sizes. Flexible (any number of summary statistics can be provided by the investigator). |Requires summary statistics as an input. Difficult for a naïve user. |https://sourceforge.net/projects/evonet/?source=typ_redirect |(Sheehan and Song, 2016) |
| FastEPRR |Supervised Machine Learning |Estimating effective recombination rates |Uses regression to estimate effective recombination rates from SNP alignments. Can use the VCF format. No clear bias due to phasing errors observed. Can incorporate demographic history (using ms command line). |Requires phased data. |https://www.picb.ac.cn/evolgen/softwares/index.html |(Gao et al., 2016) |
| FILET |Supervised Machine Learning |Detecting introgression |Uses Extra Trees classifiers and dedicated summary statistics to classify genomic windows as being introgressed or not. Identifies the direction of introgression. |Targets pulse of introgression rather than continuous gene flow, but can detect the latter. Requires phased data in a fasta format. |https://github.com/kr-colab/FILET |(Gao et al., 2016) |
| genomatnn |Supervised Machine Learning |Detecting adaptive introgression |Uses convolutional neural networks to identify adaptive introgression. Trained using the tree-sequence records obtained from SliM3. Can handle VCF files and unphased data. |Strong computational bottleneck with SliM simulations. |https://github.com/grahamgower/genomatnn |(Gower et al., 2020) |
| ImaGene |Supervised Machine Learning |Detecting selective sweeps |Uses convolutional neural networks to classify genomic windows in bins of distinct selection coefficients. Directly uses the image of the alignment, avoiding compression (i.e. using summary statistics) |Can be slow for large datasets. |https://github.com/mfumagalli/ImaGene |(Torada et al., 2019) |
| RELERNN |Supervised Machine Learning |Estimating recombination rates |Uses recurrent neural networks to estimate recombination rates from SNP alignments. Handles unphased and pooled data. Uses msprime (Python implementation of ms) to generate simulations upon which the algorithm is trained. Can incorporate known demographic history provided by the user. |Can be computationnally intensive for large effective population sizes. Accuracy on pooled data is modest for low depth of coverage. Absolute estimates of recombination rates depends on the accuracy of the mutation rate used for simulations. |https://github.com/kr-colab/ReLERNN |(Adrion, Galloway, et al., 2020) |
| SWiFr |Supervised Machine Learning |Detecting selective sweeps |Uses averaged one-dependence estimator to classify genomic regions as selected or neutral. Flexible in terms of which summary statistics are used. Can incorporate demographic history. |Requires summary statistics as an input. Only distinguishes between selective sweeps and neutral regions. |https://github.com/ramachandran-lab/SWIFr/blob/master/README.md |(Sugden et al., 2018) |

<div class="caption">
    Table 4: Summary of simulators and simulation-based methods for selection and demographic inference.
</div>




